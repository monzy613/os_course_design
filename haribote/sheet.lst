     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .data]
    10 00000000                                 _last_key:
    11 00000000 34                              	DB	52
    12                                          [SECTION .text]
    13 00000000                                 	GLOBAL	_shtctl_init
    14 00000000                                 _shtctl_init:
    15 00000000 55                              	PUSH	EBP
    16 00000001 89 E5                           	MOV	EBP,ESP
    17 00000003 57                              	PUSH	EDI
    18 00000004 56                              	PUSH	ESI
    19 00000005 53                              	PUSH	EBX
    20 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    21 00000009 68 00002C14                     	PUSH	11284
    22 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    23 00000011 56                              	PUSH	ESI
    24 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    25 00000017 89 C3                           	MOV	EBX,EAX
    26 00000019 58                              	POP	EAX
    27 0000001A 5A                              	POP	EDX
    28 0000001B 85 DB                           	TEST	EBX,EBX
    29 0000001D 74 4A                           	JE	L3
    30 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    31 00000022 0F AF C7                        	IMUL	EAX,EDI
    32 00000025 50                              	PUSH	EAX
    33 00000026 56                              	PUSH	ESI
    34 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    35 0000002C 85 C0                           	TEST	EAX,EAX
    36 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    37 00000031 5A                              	POP	EDX
    38 00000032 59                              	POP	ECX
    39 00000033 74 3E                           	JE	L11
    40 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    41 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    42 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    43 0000003D 8D 93 000027D8                  	LEA	EDX,DWORD [10200+EBX]
    44 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    45 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    46 00000049 89 D8                           	MOV	EAX,EBX
    47 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    48 00000052                                 L9:
    49 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    50 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    51 00000062 83 C0 28                        	ADD	EAX,40
    52 00000065 39 D0                           	CMP	EAX,EDX
    53 00000067 7E E9                           	JLE	L9
    54 00000069                                 L3:
    55 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    56 0000006C 89 D8                           	MOV	EAX,EBX
    57 0000006E 5B                              	POP	EBX
    58 0000006F 5E                              	POP	ESI
    59 00000070 5F                              	POP	EDI
    60 00000071 5D                              	POP	EBP
    61 00000072 C3                              	RET
    62 00000073                                 L11:
    63 00000073 68 00002C14                     	PUSH	11284
    64 00000078 53                              	PUSH	EBX
    65 00000079 56                              	PUSH	ESI
    66 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    67 0000007F 83 C4 0C                        	ADD	ESP,12
    68 00000082 EB E5                           	JMP	L3
    69 00000084                                 	GLOBAL	_sheet_alloc
    70 00000084                                 _sheet_alloc:
    71 00000084 55                              	PUSH	EBP
    72 00000085 31 D2                           	XOR	EDX,EDX
    73 00000087 89 E5                           	MOV	EBP,ESP
    74 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    75 0000008C 05 00000414                     	ADD	EAX,1044
    76 00000091                                 L18:
    77 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    78 00000095 74 10                           	JE	L21
    79 00000097 42                              	INC	EDX
    80 00000098 83 C0 28                        	ADD	EAX,40
    81 0000009B 81 FA 000000FF                  	CMP	EDX,255
    82 000000A1 7E EE                           	JLE	L18
    83 000000A3 31 C0                           	XOR	EAX,EAX
    84 000000A5                                 L12:
    85 000000A5 5D                              	POP	EBP
    86 000000A6 C3                              	RET
    87 000000A7                                 L21:
    88 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    89 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    90 000000B5 C7 40 24 00000000               	MOV	DWORD [36+EAX],0
    91 000000BC EB E7                           	JMP	L12
    92 000000BE                                 	GLOBAL	_sheet_setbuf
    93 000000BE                                 _sheet_setbuf:
    94 000000BE 55                              	PUSH	EBP
    95 000000BF 89 E5                           	MOV	EBP,ESP
    96 000000C1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    97 000000C4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    98 000000C7 89 02                           	MOV	DWORD [EDX],EAX
    99 000000C9 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   100 000000CC 89 42 04                        	MOV	DWORD [4+EDX],EAX
   101 000000CF 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   102 000000D2 89 42 08                        	MOV	DWORD [8+EDX],EAX
   103 000000D5 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   104 000000D8 89 42 14                        	MOV	DWORD [20+EDX],EAX
   105 000000DB 5D                              	POP	EBP
   106 000000DC C3                              	RET
   107 000000DD                                 	GLOBAL	_sheet_refreshmap
   108 000000DD                                 _sheet_refreshmap:
   109 000000DD 55                              	PUSH	EBP
   110 000000DE 89 E5                           	MOV	EBP,ESP
   111 000000E0 57                              	PUSH	EDI
   112 000000E1 56                              	PUSH	ESI
   113 000000E2 53                              	PUSH	EBX
   114 000000E3 83 EC 30                        	SUB	ESP,48
   115 000000E6 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   116 000000E9 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   117 000000ED 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   118 000000F0 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   119 000000F3 0F 88 00000203                  	JS	L83
   120 000000F9                                 L24:
   121 000000F9 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   122 000000FD 0F 88 000001ED                  	JS	L84
   123 00000103                                 L25:
   124 00000103 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   125 00000106 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   126 00000109 39 45 14                        	CMP	DWORD [20+EBP],EAX
   127 0000010C 7E 03                           	JLE	L26
   128 0000010E 89 45 14                        	MOV	DWORD [20+EBP],EAX
   129 00000111                                 L26:
   130 00000111 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   131 00000114 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   132 00000117 39 45 18                        	CMP	DWORD [24+EBP],EAX
   133 0000011A 7E 03                           	JLE	L27
   134 0000011C 89 45 18                        	MOV	DWORD [24+EBP],EAX
   135 0000011F                                 L27:
   136 0000011F 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   137 00000122 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   138 00000125 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   139 00000128 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   140 0000012B 0F 8F 000000DA                  	JG	L73
   141 00000131                                 L71:
   142 00000131 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   143 00000134 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   144 00000137 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   145 0000013A 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   146 0000013D 8B 7C 82 14                     	MOV	EDI,DWORD [20+EDX+EAX*4]
   147 00000141 89 F8                           	MOV	EAX,EDI
   148 00000143 29 D0                           	SUB	EAX,EDX
   149 00000145 8B 0F                           	MOV	ECX,DWORD [EDI]
   150 00000147 2D 00000414                     	SUB	EAX,1044
   151 0000014C 89 4D DC                        	MOV	DWORD [-36+EBP],ECX
   152 0000014F C1 F8 03                        	SAR	EAX,3
   153 00000152 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   154 00000155 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   155 0000015B 88 45 DB                        	MOV	BYTE [-37+EBP],AL
   156 0000015E 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   157 00000161 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   158 00000164 29 D3                           	SUB	EBX,EDX
   159 00000166 29 C6                           	SUB	ESI,EAX
   160 00000168 29 C1                           	SUB	ECX,EAX
   161 0000016A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   162 0000016D 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   163 00000170 29 D0                           	SUB	EAX,EDX
   164 00000172 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   165 00000175 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   166 00000178 0F 88 00000166                  	JS	L85
   167 0000017E                                 L32:
   168 0000017E 85 C9                           	TEST	ECX,ECX
   169 00000180 0F 88 00000157                  	JS	L86
   170 00000186                                 L33:
   171 00000186 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   172 00000189 39 45 E8                        	CMP	DWORD [-24+EBP],EAX
   173 0000018C 7E 03                           	JLE	L34
   174 0000018E 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   175 00000191                                 L34:
   176 00000191 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   177 00000194 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   178 00000197 7E 03                           	JLE	L35
   179 00000199 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   180 0000019C                                 L35:
   181 0000019C 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   182 000001A0 74 71                           	JE	L87
   183 000001A2 89 CA                           	MOV	EDX,ECX
   184 000001A4 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   185 000001A7 7D 50                           	JGE	L30
   186 000001A9                                 L70:
   187 000001A9 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   188 000001AC 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   189 000001AF 01 D0                           	ADD	EAX,EDX
   190 000001B1 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   191 000001B4 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   192 000001B7 7D 3A                           	JGE	L82
   193 000001B9                                 L69:
   194 000001B9 89 D0                           	MOV	EAX,EDX
   195 000001BB 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   196 000001BE 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   197 000001C2 01 CB                           	ADD	EBX,ECX
   198 000001C4 8B 75 DC                        	MOV	ESI,DWORD [-36+EBP]
   199 000001C7 01 C8                           	ADD	EAX,ECX
   200 000001C9 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   201 000001CC 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   202 000001D0 3B 77 14                        	CMP	ESI,DWORD [20+EDI]
   203 000001D3 74 18                           	JE	L66
   204 000001D5 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   205 000001D8 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   206 000001DB 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   207 000001DE 0F AF 58 08                     	IMUL	EBX,DWORD [8+EAX]
   208 000001E2 01 DE                           	ADD	ESI,EBX
   209 000001E4 8A 45 DB                        	MOV	AL,BYTE [-37+EBP]
   210 000001E7 8B 5D D4                        	MOV	EBX,DWORD [-44+EBP]
   211 000001EA 88 04 1E                        	MOV	BYTE [ESI+EBX*1],AL
   212 000001ED                                 L66:
   213 000001ED 41                              	INC	ECX
   214 000001EE 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   215 000001F1 7C C6                           	JL	L69
   216 000001F3                                 L82:
   217 000001F3 42                              	INC	EDX
   218 000001F4 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   219 000001F7 7C B0                           	JL	L70
   220 000001F9                                 L30:
   221 000001F9 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   222 000001FC FF 45 F0                        	INC	DWORD [-16+EBP]
   223 000001FF 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   224 00000202 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   225 00000205 0F 8E FFFFFF26                  	JLE	L71
   226 0000020B                                 L73:
   227 0000020B 83 C4 30                        	ADD	ESP,48
   228 0000020E 5B                              	POP	EBX
   229 0000020F 5E                              	POP	ESI
   230 00000210 5F                              	POP	EDI
   231 00000211 5D                              	POP	EBP
   232 00000212 C3                              	RET
   233 00000213                                 L87:
   234 00000213 83 E2 03                        	AND	EDX,3
   235 00000216 75 7F                           	JNE	L37
   236 00000218 F7 45 EC 00000003               	TEST	DWORD [-20+EBP],3
   237 0000021F 75 76                           	JNE	L37
   238 00000221 F7 45 E8 00000003               	TEST	DWORD [-24+EBP],3
   239 00000228 75 6D                           	JNE	L37
   240 0000022A 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   241 0000022D 29 55 E8                        	SUB	DWORD [-24+EBP],EDX
   242 00000230 BA 00000004                     	MOV	EDX,4
   243 00000235 89 D3                           	MOV	EBX,EDX
   244 00000237 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   245 0000023A 99                              	CDQ
   246 0000023B F7 FB                           	IDIV	EBX
   247 0000023D 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   248 00000240 89 CA                           	MOV	EDX,ECX
   249 00000242 0F B6 45 DB                     	MOVZX	EAX,BYTE [-37+EBP]
   250 00000246 89 C6                           	MOV	ESI,EAX
   251 00000248 C1 E6 08                        	SAL	ESI,8
   252 0000024B 09 C6                           	OR	ESI,EAX
   253 0000024D C1 E0 10                        	SAL	EAX,16
   254 00000250 09 C6                           	OR	ESI,EAX
   255 00000252 C1 E0 08                        	SAL	EAX,8
   256 00000255 09 C6                           	OR	ESI,EAX
   257 00000257 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   258 0000025A 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   259 0000025D 7D 9A                           	JGE	L30
   260 0000025F                                 L47:
   261 0000025F 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   262 00000262 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   263 00000265 01 D0                           	ADD	EAX,EDX
   264 00000267 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   265 0000026A 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   266 0000026E 03 4F 0C                        	ADD	ECX,DWORD [12+EDI]
   267 00000271 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   268 00000274 01 C8                           	ADD	EAX,ECX
   269 00000276 31 C9                           	XOR	ECX,ECX
   270 00000278 03 45 D4                        	ADD	EAX,DWORD [-44+EBP]
   271 0000027B 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   272 0000027E 7D 0C                           	JGE	L76
   273 00000280                                 L46:
   274 00000280 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   275 00000283 89 34 88                        	MOV	DWORD [EAX+ECX*4],ESI
   276 00000286 41                              	INC	ECX
   277 00000287 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   278 0000028A 7C F4                           	JL	L46
   279 0000028C                                 L76:
   280 0000028C 42                              	INC	EDX
   281 0000028D 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   282 00000290 7C CD                           	JL	L47
   283 00000292 E9 FFFFFF62                     	JMP	L30
   284 00000297                                 L37:
   285 00000297 89 CA                           	MOV	EDX,ECX
   286 00000299 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   287 0000029C 0F 8D FFFFFF57                  	JGE	L30
   288 000002A2                                 L58:
   289 000002A2 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   290 000002A5 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   291 000002A8 01 D0                           	ADD	EAX,EDX
   292 000002AA 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   293 000002AD 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   294 000002B0 7D 20                           	JGE	L79
   295 000002B2                                 L57:
   296 000002B2 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   297 000002B5 8B 45 C4                        	MOV	EAX,DWORD [-60+EBP]
   298 000002B8 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   299 000002BB 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   300 000002BF 01 CB                           	ADD	EBX,ECX
   301 000002C1 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   302 000002C4 01 C3                           	ADD	EBX,EAX
   303 000002C6 41                              	INC	ECX
   304 000002C7 8A 45 DB                        	MOV	AL,BYTE [-37+EBP]
   305 000002CA 88 04 33                        	MOV	BYTE [EBX+ESI*1],AL
   306 000002CD 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   307 000002D0 7C E0                           	JL	L57
   308 000002D2                                 L79:
   309 000002D2 42                              	INC	EDX
   310 000002D3 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   311 000002D6 7C CA                           	JL	L58
   312 000002D8 E9 FFFFFF1C                     	JMP	L30
   313 000002DD                                 L86:
   314 000002DD 31 C9                           	XOR	ECX,ECX
   315 000002DF E9 FFFFFEA2                     	JMP	L33
   316 000002E4                                 L85:
   317 000002E4 C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   318 000002EB E9 FFFFFE8E                     	JMP	L32
   319 000002F0                                 L84:
   320 000002F0 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   321 000002F7 E9 FFFFFE07                     	JMP	L25
   322 000002FC                                 L83:
   323 000002FC C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   324 00000303 E9 FFFFFDF1                     	JMP	L24
   325 00000308                                 	GLOBAL	_sheet_refreshsub
   326 00000308                                 _sheet_refreshsub:
   327 00000308 55                              	PUSH	EBP
   328 00000309 89 E5                           	MOV	EBP,ESP
   329 0000030B 57                              	PUSH	EDI
   330 0000030C 56                              	PUSH	ESI
   331 0000030D 53                              	PUSH	EBX
   332 0000030E 83 EC 54                        	SUB	ESP,84
   333 00000311 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   334 00000314 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   335 00000317 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   336 0000031B 8B 00                           	MOV	EAX,DWORD [EAX]
   337 0000031D 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   338 00000320 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   339 00000323 89 55 C0                        	MOV	DWORD [-64+EBP],EDX
   340 00000326 0F 88 000003B2                  	JS	L155
   341 0000032C                                 L89:
   342 0000032C 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   343 00000330 0F 88 0000039C                  	JS	L156
   344 00000336                                 L90:
   345 00000336 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   346 00000339 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   347 0000033C 39 45 14                        	CMP	DWORD [20+EBP],EAX
   348 0000033F 7E 03                           	JLE	L91
   349 00000341 89 45 14                        	MOV	DWORD [20+EBP],EAX
   350 00000344                                 L91:
   351 00000344 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   352 00000347 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   353 0000034A 39 45 18                        	CMP	DWORD [24+EBP],EAX
   354 0000034D 7E 03                           	JLE	L92
   355 0000034F 89 45 18                        	MOV	DWORD [24+EBP],EAX
   356 00000352                                 L92:
   357 00000352 8B 75 1C                        	MOV	ESI,DWORD [28+EBP]
   358 00000355 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   359 00000358 89 75 F0                        	MOV	DWORD [-16+EBP],ESI
   360 0000035B 39 C6                           	CMP	ESI,EAX
   361 0000035D 0F 8F 0000023B                  	JG	L145
   362 00000363                                 L143:
   363 00000363 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   364 00000366 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   365 00000369 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   366 0000036C 8B 7C 91 14                     	MOV	EDI,DWORD [20+ECX+EDX*4]
   367 00000370 89 F8                           	MOV	EAX,EDI
   368 00000372 29 C8                           	SUB	EAX,ECX
   369 00000374 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   370 00000377 2D 00000414                     	SUB	EAX,1044
   371 0000037C 29 D6                           	SUB	ESI,EDX
   372 0000037E C1 F8 03                        	SAR	EAX,3
   373 00000381 8B 1F                           	MOV	EBX,DWORD [EDI]
   374 00000383 69 C0 CCCCCCCD                  	IMUL	EAX,EAX,-858993459
   375 00000389 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   376 0000038C 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   377 0000038F 88 45 BF                        	MOV	BYTE [-65+EBP],AL
   378 00000392 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   379 00000395 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   380 00000398 8B 5D 18                        	MOV	EBX,DWORD [24+EBP]
   381 0000039B 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   382 0000039E 29 C3                           	SUB	EBX,EAX
   383 000003A0 29 C1                           	SUB	ECX,EAX
   384 000003A2 89 5D E0                        	MOV	DWORD [-32+EBP],EBX
   385 000003A5 29 D6                           	SUB	ESI,EDX
   386 000003A7 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   387 000003AA 0F 88 00000316                  	JS	L157
   388 000003B0                                 L97:
   389 000003B0 85 C9                           	TEST	ECX,ECX
   390 000003B2 0F 88 00000307                  	JS	L158
   391 000003B8                                 L98:
   392 000003B8 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   393 000003BB 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   394 000003BE 7E 03                           	JLE	L99
   395 000003C0 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   396 000003C3                                 L99:
   397 000003C3 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   398 000003C6 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   399 000003C9 7E 03                           	JLE	L100
   400 000003CB 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   401 000003CE                                 L100:
   402 000003CE 83 E2 03                        	AND	EDX,3
   403 000003D1 0F 85 00000286                  	JNE	L101
   404 000003D7 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   405 000003DA BB 00000004                     	MOV	EBX,4
   406 000003DF 83 C2 03                        	ADD	EDX,3
   407 000003E2 89 D0                           	MOV	EAX,EDX
   408 000003E4 99                              	CDQ
   409 000003E5 F7 FB                           	IDIV	EBX
   410 000003E7 89 45 A4                        	MOV	DWORD [-92+EBP],EAX
   411 000003EA 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   412 000003ED 99                              	CDQ
   413 000003EE F7 FB                           	IDIV	EBX
   414 000003F0 8B 55 A4                        	MOV	EDX,DWORD [-92+EBP]
   415 000003F3 29 D0                           	SUB	EAX,EDX
   416 000003F5 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   417 000003F8 0F B6 45 BF                     	MOVZX	EAX,BYTE [-65+EBP]
   418 000003FC 89 C3                           	MOV	EBX,EAX
   419 000003FE C1 E3 08                        	SAL	EBX,8
   420 00000401 09 C3                           	OR	EBX,EAX
   421 00000403 C1 E0 10                        	SAL	EAX,16
   422 00000406 09 C3                           	OR	EBX,EAX
   423 00000408 C1 E0 08                        	SAL	EAX,8
   424 0000040B 09 C3                           	OR	EBX,EAX
   425 0000040D 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   426 00000410 89 5D DC                        	MOV	DWORD [-36+EBP],EBX
   427 00000413 89 CB                           	MOV	EBX,ECX
   428 00000415 0F 8D 00000174                  	JGE	L95
   429 0000041B                                 L130:
   430 0000041B 8B 77 10                        	MOV	ESI,DWORD [16+EDI]
   431 0000041E 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   432 00000421 01 DE                           	ADD	ESI,EBX
   433 00000423 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   434 00000426 89 75 EC                        	MOV	DWORD [-20+EBP],ESI
   435 00000429 7D 3D                           	JGE	L107
   436 0000042B F7 C2 00000003                  	TEST	EDX,3
   437 00000431 74 35                           	JE	L107
   438 00000433                                 L112:
   439 00000433 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   440 00000436 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   441 00000439 01 D0                           	ADD	EAX,EDX
   442 0000043B 89 45 A8                        	MOV	DWORD [-88+EBP],EAX
   443 0000043E 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   444 00000441 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   445 00000445 8B 75 A8                        	MOV	ESI,DWORD [-88+EBP]
   446 00000448 8D 0C 06                        	LEA	ECX,DWORD [ESI+EAX*1]
   447 0000044B 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   448 0000044E 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   449 00000451 38 04 31                        	CMP	BYTE [ECX+ESI*1],AL
   450 00000454 0F 84 000001EA                  	JE	L159
   451 0000045A                                 L108:
   452 0000045A 42                              	INC	EDX
   453 0000045B 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   454 0000045E 7D 08                           	JGE	L107
   455 00000460 F7 C2 00000003                  	TEST	EDX,3
   456 00000466 75 CB                           	JNE	L112
   457 00000468                                 L107:
   458 00000468 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   459 0000046B 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   460 0000046E 01 D0                           	ADD	EAX,EDX
   461 00000470 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   462 00000473 89 45 A8                        	MOV	DWORD [-88+EBP],EAX
   463 00000476 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   464 00000479 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   465 0000047D 03 45 A8                        	ADD	EAX,DWORD [-88+EBP]
   466 00000480 01 C6                           	ADD	ESI,EAX
   467 00000482 03 45 C4                        	ADD	EAX,DWORD [-60+EBP]
   468 00000485 89 75 D4                        	MOV	DWORD [-44+EBP],ESI
   469 00000488 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   470 0000048B 89 D8                           	MOV	EAX,EBX
   471 0000048D 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   472 00000491 01 D0                           	ADD	EAX,EDX
   473 00000493 03 45 C8                        	ADD	EAX,DWORD [-56+EBP]
   474 00000496 C7 45 A4 00000000               	MOV	DWORD [-92+EBP],0
   475 0000049D 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   476 000004A0 8B 45 D8                        	MOV	EAX,DWORD [-40+EBP]
   477 000004A3 39 45 A4                        	CMP	DWORD [-92+EBP],EAX
   478 000004A6 0F 8D 000000AB                  	JGE	L149
   479 000004AC 89 55 AC                        	MOV	DWORD [-84+EBP],EDX
   480 000004AF                                 L123:
   481 000004AF 8B 4D A4                        	MOV	ECX,DWORD [-92+EBP]
   482 000004B2 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   483 000004B5 8B 45 DC                        	MOV	EAX,DWORD [-36+EBP]
   484 000004B8 39 04 8E                        	CMP	DWORD [ESI+ECX*4],EAX
   485 000004BB 0F 84 00000172                  	JE	L160
   486 000004C1 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   487 000004C4 8B 75 EC                        	MOV	ESI,DWORD [-20+EBP]
   488 000004C7 8B 45 AC                        	MOV	EAX,DWORD [-84+EBP]
   489 000004CA 0F AF 71 08                     	IMUL	ESI,DWORD [8+ECX]
   490 000004CE 03 47 0C                        	ADD	EAX,DWORD [12+EDI]
   491 000004D1 8B 4D C0                        	MOV	ECX,DWORD [-64+EBP]
   492 000004D4 01 C6                           	ADD	ESI,EAX
   493 000004D6 89 45 A8                        	MOV	DWORD [-88+EBP],EAX
   494 000004D9 89 75 B8                        	MOV	DWORD [-72+EBP],ESI
   495 000004DC 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   496 000004DF 38 04 0E                        	CMP	BYTE [ESI+ECX*1],AL
   497 000004E2 0F 84 0000012E                  	JE	L161
   498 000004E8                                 L119:
   499 000004E8 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   500 000004EB 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   501 000004EE 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   502 000004F1 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   503 000004F5 03 45 A8                        	ADD	EAX,DWORD [-88+EBP]
   504 000004F8 8A 4D BF                        	MOV	CL,BYTE [-65+EBP]
   505 000004FB 89 45 B4                        	MOV	DWORD [-76+EBP],EAX
   506 000004FE 38 4C 30 01                     	CMP	BYTE [1+EAX+ESI*1],CL
   507 00000502 0F 84 000000EF                  	JE	L162
   508 00000508                                 L120:
   509 00000508 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   510 0000050B 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   511 0000050E 8A 4D BF                        	MOV	CL,BYTE [-65+EBP]
   512 00000511 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   513 00000515 03 45 A8                        	ADD	EAX,DWORD [-88+EBP]
   514 00000518 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   515 0000051B 89 45 B0                        	MOV	DWORD [-80+EBP],EAX
   516 0000051E 38 4C 30 02                     	CMP	BYTE [2+EAX+ESI*1],CL
   517 00000522 0F 84 000000B0                  	JE	L163
   518 00000528                                 L121:
   519 00000528 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   520 0000052B 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   521 0000052E 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   522 00000532 8B 75 A8                        	MOV	ESI,DWORD [-88+EBP]
   523 00000535 8D 0C 06                        	LEA	ECX,DWORD [ESI+EAX*1]
   524 00000538 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   525 0000053B 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   526 0000053E 38 44 31 03                     	CMP	BYTE [3+ECX+ESI*1],AL
   527 00000542 74 78                           	JE	L164
   528 00000544                                 L115:
   529 00000544 8B 45 D8                        	MOV	EAX,DWORD [-40+EBP]
   530 00000547 FF 45 A4                        	INC	DWORD [-92+EBP]
   531 0000054A 83 45 AC 04                     	ADD	DWORD [-84+EBP],4
   532 0000054E 39 45 A4                        	CMP	DWORD [-92+EBP],EAX
   533 00000551 0F 8C FFFFFF58                  	JL	L123
   534 00000557                                 L149:
   535 00000557 8B 4D D8                        	MOV	ECX,DWORD [-40+EBP]
   536 0000055A 8D 14 8A                        	LEA	EDX,DWORD [EDX+ECX*4]
   537 0000055D 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   538 00000560 7D 23                           	JGE	L151
   539 00000562                                 L129:
   540 00000562 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   541 00000565 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   542 00000568 8B 77 0C                        	MOV	ESI,DWORD [12+EDI]
   543 0000056B 0F AF 41 08                     	IMUL	EAX,DWORD [8+ECX]
   544 0000056F 01 D6                           	ADD	ESI,EDX
   545 00000571 8D 0C 06                        	LEA	ECX,DWORD [ESI+EAX*1]
   546 00000574 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   547 00000577 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   548 0000057A 38 04 31                        	CMP	BYTE [ECX+ESI*1],AL
   549 0000057D 74 27                           	JE	L165
   550 0000057F                                 L126:
   551 0000057F 42                              	INC	EDX
   552 00000580 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   553 00000583 7C DD                           	JL	L129
   554 00000585                                 L151:
   555 00000585 43                              	INC	EBX
   556 00000586 3B 5D E0                        	CMP	EBX,DWORD [-32+EBP]
   557 00000589 0F 8C FFFFFE8C                  	JL	L130
   558 0000058F                                 L95:
   559 0000058F 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   560 00000592 FF 45 F0                        	INC	DWORD [-16+EBP]
   561 00000595 39 45 F0                        	CMP	DWORD [-16+EBP],EAX
   562 00000598 0F 8E FFFFFDC5                  	JLE	L143
   563 0000059E                                 L145:
   564 0000059E 83 C4 54                        	ADD	ESP,84
   565 000005A1 5B                              	POP	EBX
   566 000005A2 5E                              	POP	ESI
   567 000005A3 5F                              	POP	EDI
   568 000005A4 5D                              	POP	EBP
   569 000005A5 C3                              	RET
   570 000005A6                                 L165:
   571 000005A6 89 D8                           	MOV	EAX,EBX
   572 000005A8 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   573 000005AB 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   574 000005AF 01 D0                           	ADD	EAX,EDX
   575 000005B1 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   576 000005B4 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   577 000005B7 88 04 31                        	MOV	BYTE [ECX+ESI*1],AL
   578 000005BA EB C3                           	JMP	L126
   579 000005BC                                 L164:
   580 000005BC 89 D8                           	MOV	EAX,EBX
   581 000005BE 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   582 000005C1 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   583 000005C5 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   584 000005C8 8A 44 30 03                     	MOV	AL,BYTE [3+EAX+ESI*1]
   585 000005CC 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   586 000005CF 88 44 31 03                     	MOV	BYTE [3+ECX+ESI*1],AL
   587 000005D3 E9 FFFFFF6C                     	JMP	L115
   588 000005D8                                 L163:
   589 000005D8 89 D8                           	MOV	EAX,EBX
   590 000005DA 8B 4D C8                        	MOV	ECX,DWORD [-56+EBP]
   591 000005DD 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   592 000005E1 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   593 000005E4 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   594 000005E7 8A 44 08 02                     	MOV	AL,BYTE [2+EAX+ECX*1]
   595 000005EB 8B 4D B0                        	MOV	ECX,DWORD [-80+EBP]
   596 000005EE 88 44 31 02                     	MOV	BYTE [2+ECX+ESI*1],AL
   597 000005F2 E9 FFFFFF31                     	JMP	L121
   598 000005F7                                 L162:
   599 000005F7 89 D8                           	MOV	EAX,EBX
   600 000005F9 8B 4D C8                        	MOV	ECX,DWORD [-56+EBP]
   601 000005FC 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   602 00000600 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   603 00000603 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   604 00000606 8A 44 08 01                     	MOV	AL,BYTE [1+EAX+ECX*1]
   605 0000060A 8B 4D B4                        	MOV	ECX,DWORD [-76+EBP]
   606 0000060D 88 44 31 01                     	MOV	BYTE [1+ECX+ESI*1],AL
   607 00000611 E9 FFFFFEF2                     	JMP	L120
   608 00000616                                 L161:
   609 00000616 89 D8                           	MOV	EAX,EBX
   610 00000618 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   611 0000061B 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   612 0000061F 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   613 00000622 8B 4D C4                        	MOV	ECX,DWORD [-60+EBP]
   614 00000625 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   615 00000628 8B 75 B8                        	MOV	ESI,DWORD [-72+EBP]
   616 0000062B 88 04 0E                        	MOV	BYTE [ESI+ECX*1],AL
   617 0000062E E9 FFFFFEB5                     	JMP	L119
   618 00000633                                 L160:
   619 00000633 8B 75 CC                        	MOV	ESI,DWORD [-52+EBP]
   620 00000636 8B 04 8E                        	MOV	EAX,DWORD [ESI+ECX*4]
   621 00000639 8B 75 D0                        	MOV	ESI,DWORD [-48+EBP]
   622 0000063C 89 04 8E                        	MOV	DWORD [ESI+ECX*4],EAX
   623 0000063F E9 FFFFFF00                     	JMP	L115
   624 00000644                                 L159:
   625 00000644 89 D8                           	MOV	EAX,EBX
   626 00000646 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   627 00000649 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   628 0000064D 01 D0                           	ADD	EAX,EDX
   629 0000064F 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   630 00000652 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   631 00000655 88 04 31                        	MOV	BYTE [ECX+ESI*1],AL
   632 00000658 E9 FFFFFDFD                     	JMP	L108
   633 0000065D                                 L101:
   634 0000065D 89 CB                           	MOV	EBX,ECX
   635 0000065F 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   636 00000662 0F 8D FFFFFF27                  	JGE	L95
   637 00000668                                 L142:
   638 00000668 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   639 0000066B 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   640 0000066E 01 D8                           	ADD	EAX,EBX
   641 00000670 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   642 00000673 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   643 00000676 7D 26                           	JGE	L154
   644 00000678                                 L141:
   645 00000678 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   646 0000067B 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   647 0000067E 8B 4F 0C                        	MOV	ECX,DWORD [12+EDI]
   648 00000681 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   649 00000685 01 D1                           	ADD	ECX,EDX
   650 00000687 8B 75 C0                        	MOV	ESI,DWORD [-64+EBP]
   651 0000068A 89 4D A8                        	MOV	DWORD [-88+EBP],ECX
   652 0000068D 8D 0C 01                        	LEA	ECX,DWORD [ECX+EAX*1]
   653 00000690 8A 45 BF                        	MOV	AL,BYTE [-65+EBP]
   654 00000693 38 04 31                        	CMP	BYTE [ECX+ESI*1],AL
   655 00000696 74 11                           	JE	L166
   656 00000698                                 L138:
   657 00000698 42                              	INC	EDX
   658 00000699 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   659 0000069C 7C DA                           	JL	L141
   660 0000069E                                 L154:
   661 0000069E 43                              	INC	EBX
   662 0000069F 3B 5D E0                        	CMP	EBX,DWORD [-32+EBP]
   663 000006A2 7C C4                           	JL	L142
   664 000006A4 E9 FFFFFEE6                     	JMP	L95
   665 000006A9                                 L166:
   666 000006A9 89 D8                           	MOV	EAX,EBX
   667 000006AB 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   668 000006AE 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   669 000006B2 01 D0                           	ADD	EAX,EDX
   670 000006B4 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   671 000006B7 8B 75 C4                        	MOV	ESI,DWORD [-60+EBP]
   672 000006BA 88 04 31                        	MOV	BYTE [ECX+ESI*1],AL
   673 000006BD EB D9                           	JMP	L138
   674 000006BF                                 L158:
   675 000006BF 31 C9                           	XOR	ECX,ECX
   676 000006C1 E9 FFFFFCF2                     	JMP	L98
   677 000006C6                                 L157:
   678 000006C6 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   679 000006CD E9 FFFFFCDE                     	JMP	L97
   680 000006D2                                 L156:
   681 000006D2 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   682 000006D9 E9 FFFFFC58                     	JMP	L90
   683 000006DE                                 L155:
   684 000006DE C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   685 000006E5 E9 FFFFFC42                     	JMP	L89
   686 000006EA                                 	GLOBAL	_sheet_updown
   687 000006EA                                 _sheet_updown:
   688 000006EA 55                              	PUSH	EBP
   689 000006EB 89 E5                           	MOV	EBP,ESP
   690 000006ED 57                              	PUSH	EDI
   691 000006EE 56                              	PUSH	ESI
   692 000006EF 53                              	PUSH	EBX
   693 000006F0 51                              	PUSH	ECX
   694 000006F1 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   695 000006F4 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   696 000006F7 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   697 000006FA 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   698 000006FD 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   699 00000700 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   700 00000703 40                              	INC	EAX
   701 00000704 39 C3                           	CMP	EBX,EAX
   702 00000706 7E 02                           	JLE	L168
   703 00000708 89 C3                           	MOV	EBX,EAX
   704 0000070A                                 L168:
   705 0000070A 83 FB FF                        	CMP	EBX,-1
   706 0000070D 7D 03                           	JGE	L169
   707 0000070F 83 CB FF                        	OR	EBX,-1
   708 00000712                                 L169:
   709 00000712 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   710 00000715 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   711 00000718 0F 8E 000000A8                  	JLE	L170
   712 0000071E 85 DB                           	TEST	EBX,EBX
   713 00000720 78 5C                           	JS	L171
   714 00000722 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   715 00000725                                 L176:
   716 00000725 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   717 00000729 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   718 0000072D 89 48 18                        	MOV	DWORD [24+EAX],ECX
   719 00000730 49                              	DEC	ECX
   720 00000731 39 D9                           	CMP	ECX,EBX
   721 00000733 7F F0                           	JG	L176
   722 00000735 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   723 00000739 43                              	INC	EBX
   724 0000073A 53                              	PUSH	EBX
   725 0000073B 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   726 0000073E 89 C8                           	MOV	EAX,ECX
   727 00000740 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   728 00000743 50                              	PUSH	EAX
   729 00000744 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   730 00000747 89 D0                           	MOV	EAX,EDX
   731 00000749 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   732 0000074C 50                              	PUSH	EAX
   733 0000074D 51                              	PUSH	ECX
   734 0000074E 52                              	PUSH	EDX
   735 0000074F 56                              	PUSH	ESI
   736 00000750 E8 FFFFF988                     	CALL	_sheet_refreshmap
   737 00000755 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   738 00000758                                 L206:
   739 00000758 53                              	PUSH	EBX
   740 00000759                                 L205:
   741 00000759 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   742 0000075C 89 C8                           	MOV	EAX,ECX
   743 0000075E 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   744 00000761 50                              	PUSH	EAX
   745 00000762 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   746 00000765 89 D0                           	MOV	EAX,EDX
   747 00000767 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   748 0000076A 50                              	PUSH	EAX
   749 0000076B 51                              	PUSH	ECX
   750 0000076C 52                              	PUSH	EDX
   751 0000076D 56                              	PUSH	ESI
   752 0000076E E8 FFFFFB95                     	CALL	_sheet_refreshsub
   753 00000773 83 C4 34                        	ADD	ESP,52
   754 00000776                                 L167:
   755 00000776 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   756 00000779 5B                              	POP	EBX
   757 0000077A 5E                              	POP	ESI
   758 0000077B 5F                              	POP	EDI
   759 0000077C 5D                              	POP	EBP
   760 0000077D C3                              	RET
   761 0000077E                                 L171:
   762 0000077E 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   763 00000781 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   764 00000784 7E 18                           	JLE	L178
   765 00000786 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   766 00000789 39 C1                           	CMP	ECX,EAX
   767 0000078B 7D 11                           	JGE	L178
   768 0000078D                                 L183:
   769 0000078D 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   770 00000791 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   771 00000795 89 48 18                        	MOV	DWORD [24+EAX],ECX
   772 00000798 41                              	INC	ECX
   773 00000799 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   774 0000079C 7C EF                           	JL	L183
   775 0000079E                                 L178:
   776 0000079E FF 4E 10                        	DEC	DWORD [16+ESI]
   777 000007A1 6A 00                           	PUSH	0
   778 000007A3 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   779 000007A6 89 C8                           	MOV	EAX,ECX
   780 000007A8 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   781 000007AB 50                              	PUSH	EAX
   782 000007AC 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   783 000007AF 89 D0                           	MOV	EAX,EDX
   784 000007B1 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   785 000007B4 50                              	PUSH	EAX
   786 000007B5 51                              	PUSH	ECX
   787 000007B6 52                              	PUSH	EDX
   788 000007B7 56                              	PUSH	ESI
   789 000007B8 E8 FFFFF920                     	CALL	_sheet_refreshmap
   790 000007BD 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   791 000007C0 48                              	DEC	EAX
   792 000007C1 50                              	PUSH	EAX
   793 000007C2 6A 00                           	PUSH	0
   794 000007C4 EB 93                           	JMP	L205
   795 000007C6                                 L170:
   796 000007C6 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   797 000007C9 7D AB                           	JGE	L167
   798 000007CB 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   799 000007CF 78 3C                           	JS	L186
   800 000007D1 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   801 000007D4 39 D9                           	CMP	ECX,EBX
   802 000007D6 7D 10                           	JGE	L202
   803 000007D8                                 L191:
   804 000007D8 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   805 000007DC 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   806 000007E0 89 48 18                        	MOV	DWORD [24+EAX],ECX
   807 000007E3 41                              	INC	ECX
   808 000007E4 39 D9                           	CMP	ECX,EBX
   809 000007E6 7C F0                           	JL	L191
   810 000007E8                                 L202:
   811 000007E8 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   812 000007EC                                 L192:
   813 000007EC 53                              	PUSH	EBX
   814 000007ED 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   815 000007F0 89 C8                           	MOV	EAX,ECX
   816 000007F2 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   817 000007F5 50                              	PUSH	EAX
   818 000007F6 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   819 000007F9 89 D0                           	MOV	EAX,EDX
   820 000007FB 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   821 000007FE 50                              	PUSH	EAX
   822 000007FF 51                              	PUSH	ECX
   823 00000800 52                              	PUSH	EDX
   824 00000801 56                              	PUSH	ESI
   825 00000802 E8 FFFFF8D6                     	CALL	_sheet_refreshmap
   826 00000807 53                              	PUSH	EBX
   827 00000808 E9 FFFFFF4B                     	JMP	L206
   828 0000080D                                 L186:
   829 0000080D 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   830 00000810 39 D9                           	CMP	ECX,EBX
   831 00000812 7C 13                           	JL	L204
   832 00000814                                 L197:
   833 00000814 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   834 00000818 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   835 0000081B 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   836 0000081F 49                              	DEC	ECX
   837 00000820 89 42 18                        	MOV	DWORD [24+EDX],EAX
   838 00000823 39 D9                           	CMP	ECX,EBX
   839 00000825 7D ED                           	JGE	L197
   840 00000827                                 L204:
   841 00000827 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   842 0000082B FF 46 10                        	INC	DWORD [16+ESI]
   843 0000082E EB BC                           	JMP	L192
   844 00000830                                 	GLOBAL	_sheet_refresh
   845 00000830                                 _sheet_refresh:
   846 00000830 55                              	PUSH	EBP
   847 00000831 89 E5                           	MOV	EBP,ESP
   848 00000833 53                              	PUSH	EBX
   849 00000834 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   850 00000837 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   851 0000083A 85 C0                           	TEST	EAX,EAX
   852 0000083C 78 27                           	JS	L207
   853 0000083E 50                              	PUSH	EAX
   854 0000083F 50                              	PUSH	EAX
   855 00000840 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   856 00000843 89 C8                           	MOV	EAX,ECX
   857 00000845 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   858 00000848 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   859 0000084B 50                              	PUSH	EAX
   860 0000084C 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   861 0000084F 89 D0                           	MOV	EAX,EDX
   862 00000851 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   863 00000854 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   864 00000857 50                              	PUSH	EAX
   865 00000858 51                              	PUSH	ECX
   866 00000859 52                              	PUSH	EDX
   867 0000085A FF 73 20                        	PUSH	DWORD [32+EBX]
   868 0000085D E8 FFFFFAA6                     	CALL	_sheet_refreshsub
   869 00000862 83 C4 1C                        	ADD	ESP,28
   870 00000865                                 L207:
   871 00000865 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   872 00000868 C9                              	LEAVE
   873 00000869 C3                              	RET
   874 0000086A                                 	GLOBAL	_sheet_slide
   875 0000086A                                 _sheet_slide:
   876 0000086A 55                              	PUSH	EBP
   877 0000086B 89 E5                           	MOV	EBP,ESP
   878 0000086D 57                              	PUSH	EDI
   879 0000086E 56                              	PUSH	ESI
   880 0000086F 53                              	PUSH	EBX
   881 00000870 53                              	PUSH	EBX
   882 00000871 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   883 00000874 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   884 00000877 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   885 0000087A 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   886 0000087D 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   887 00000880 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   888 00000883 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   889 00000886 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   890 00000889 89 43 10                        	MOV	DWORD [16+EBX],EAX
   891 0000088C 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   892 00000890 78 7C                           	JS	L209
   893 00000892 6A 00                           	PUSH	0
   894 00000894 89 F0                           	MOV	EAX,ESI
   895 00000896 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   896 00000899 50                              	PUSH	EAX
   897 0000089A 89 F8                           	MOV	EAX,EDI
   898 0000089C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   899 0000089F 50                              	PUSH	EAX
   900 000008A0 56                              	PUSH	ESI
   901 000008A1 57                              	PUSH	EDI
   902 000008A2 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   903 000008A5 E8 FFFFF833                     	CALL	_sheet_refreshmap
   904 000008AA 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   905 000008AD FF 73 18                        	PUSH	DWORD [24+EBX]
   906 000008B0 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   907 000008B3 50                              	PUSH	EAX
   908 000008B4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   909 000008B7 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   910 000008BA 50                              	PUSH	EAX
   911 000008BB FF 75 10                        	PUSH	DWORD [16+EBP]
   912 000008BE FF 75 0C                        	PUSH	DWORD [12+EBP]
   913 000008C1 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   914 000008C4 E8 FFFFF814                     	CALL	_sheet_refreshmap
   915 000008C9 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   916 000008CC 83 C4 30                        	ADD	ESP,48
   917 000008CF 48                              	DEC	EAX
   918 000008D0 50                              	PUSH	EAX
   919 000008D1 89 F0                           	MOV	EAX,ESI
   920 000008D3 6A 00                           	PUSH	0
   921 000008D5 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   922 000008D8 50                              	PUSH	EAX
   923 000008D9 89 F8                           	MOV	EAX,EDI
   924 000008DB 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   925 000008DE 50                              	PUSH	EAX
   926 000008DF 56                              	PUSH	ESI
   927 000008E0 57                              	PUSH	EDI
   928 000008E1 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   929 000008E4 E8 FFFFFA1F                     	CALL	_sheet_refreshsub
   930 000008E9 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   931 000008EC FF 73 18                        	PUSH	DWORD [24+EBX]
   932 000008EF FF 73 18                        	PUSH	DWORD [24+EBX]
   933 000008F2 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   934 000008F5 50                              	PUSH	EAX
   935 000008F6 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   936 000008F9 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   937 000008FC 50                              	PUSH	EAX
   938 000008FD FF 75 10                        	PUSH	DWORD [16+EBP]
   939 00000900 FF 75 0C                        	PUSH	DWORD [12+EBP]
   940 00000903 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   941 00000906 E8 FFFFF9FD                     	CALL	_sheet_refreshsub
   942 0000090B 83 C4 38                        	ADD	ESP,56
   943 0000090E                                 L209:
   944 0000090E 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   945 00000911 5B                              	POP	EBX
   946 00000912 5E                              	POP	ESI
   947 00000913 5F                              	POP	EDI
   948 00000914 5D                              	POP	EBP
   949 00000915 C3                              	RET
   950 00000916                                 	GLOBAL	_sheet_free
   951 00000916                                 _sheet_free:
   952 00000916 55                              	PUSH	EBP
   953 00000917 89 E5                           	MOV	EBP,ESP
   954 00000919 53                              	PUSH	EBX
   955 0000091A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   956 0000091D 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   957 00000921 78 0A                           	JS	L212
   958 00000923 6A FF                           	PUSH	-1
   959 00000925 53                              	PUSH	EBX
   960 00000926 E8 FFFFFDBF                     	CALL	_sheet_updown
   961 0000092B 58                              	POP	EAX
   962 0000092C 5A                              	POP	EDX
   963 0000092D                                 L212:
   964 0000092D C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   965 00000934 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   966 00000937 C9                              	LEAVE
   967 00000938 C3                              	RET
